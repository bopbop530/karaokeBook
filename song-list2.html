<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="version" content="2.0.0" />
    <title>Yomo Song List</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Noto+Sans+KR:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        /* --- BRIGHT BUBBLE GUM PALETTE (Light Mode) --- */
        --bg-color: #fff0f5;
        --header-bg: rgba(255, 255, 255, 0.9);
        --card-bg: #ffffff;
        --primary-text: #c71585;
        --secondary-text: #ff69b4;
        --muted-text: #db7093;
        --accent-pop: #ff1493;
        --shadow-color: rgba(255, 105, 180, 0.25);
        --border-radius: 20px;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Quicksand", "Noto Sans KR", sans-serif;
        background-color: var(--bg-color);
        color: var(--primary-text);
        background-image: radial-gradient(
            circle at 5% 5%,
            #ffe4e1 0%,
            transparent 20%
          ),
          radial-gradient(circle at 95% 95%, #e6e6fa 0%, transparent 20%);
        min-height: 100vh;
        padding-bottom: 100px;
      }

      /* --- HEADER --- */
      .header-container {
        position: sticky;
        top: 0;
        z-index: 100;
        background: var(--header-bg);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-bottom: 2px solid #ffb6c1;
        box-shadow: 0 4px 15px var(--shadow-color);
        display: flex;
        flex-direction: column;
        gap: 15px;
        border-radius: 0 0 25px 25px;
        align-items: center;
      }

      h1 {
        font-size: 1.8rem;
        color: var(--accent-pop);
        font-weight: 800;
        text-align: center;
        letter-spacing: -1px;
      }

      /* --- CONTROLS --- */
      .controls {
        display: flex;
        gap: 8px;
        flex-wrap: wrap; /* Allows wrapping on very small screens */
        width: 35%;
        align-items: center;
      }

      input,
      select,
      .toggle-btn {
        border: 2px solid #ffb6c1;
        padding: 10px 14px;
        border-radius: 50px;
        font-size: 0.95rem;
        outline: none;
        transition: 0.2s;
        font-family: inherit;
        font-weight: 600;
        height: 45px; /* Uniform height */
      }

      input {
        background: #fff;
        color: var(--primary-text);
        flex: 1; /* Takes remaining space */
        min-width: 150px;
      }

      select {
        background: #fff;
        color: var(--muted-text);
        width: auto;
      }

      /* The New Recommendation Toggle Button */
      .toggle-btn {
        background: #fff;
        color: var(--accent-pop);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
        white-space: nowrap;
      }

      /* Active State for Toggle */
      .toggle-btn.active {
        background: var(--accent-pop);
        color: white;
        border-color: var(--accent-pop);
        box-shadow: 0 4px 10px rgba(255, 20, 147, 0.4);
      }

      input::placeholder {
        color: #ffc0cb;
      }

      /* --- LIST STYLING --- */
      #karaoke-book {
        padding: 25px;
        max-width: 800px;
        margin: 0 auto;
      }

      .section {
        margin-bottom: 30px;
      }

      .letter {
        font-size: 2rem;
        font-weight: 800;
        color: var(--accent-pop);
        background: white;
        display: inline-block;
        padding: 5px 20px;
        border-radius: 50px;
        margin-bottom: 15px;
        box-shadow: 0 4px 10px var(--shadow-color);
      }

      .artist {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--secondary-text);
        margin-top: 15px;
        margin-bottom: 10px;
        padding-left: 10px;
      }

      .song {
        background: var(--card-bg);
        padding: 18px 20px;
        border-radius: var(--border-radius);
        margin-bottom: 12px;
        font-size: 1.05rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        transition: transform 0.2s;
        box-shadow: 0 5px 15px rgba(230, 230, 250, 0.8);
        border: 2px solid transparent;
      }

      .song-title {
        margin-right: auto; /* Pushes badge to right */
      }

      .song .highlight {
        color: var(--muted-text);
        font-size: 0.9em;
        margin-left: 8px;
        font-weight: 400;
      }

      /* --- UPDATED BADGE CSS (Rainbow & Bigger) --- */
      .recommend-badge {
        /* Size & Shape */
        font-size: 0.9rem;
        padding: 6px 14px;
        border-radius: 50px;
        margin-left: 12px;
        font-weight: 800;
        white-space: nowrap;
        position: relative;
        top: -1px;

        /* TEXT COLOR: Deep Pink (Super readable on pastels) */
        color: #c71585;

        /* BACKGROUND: Pastel Rainbow (Pink, Peach, Lemon, Mint, Periwinkle) */
        background: linear-gradient(
          124deg,
          #ffc4e1,
          /* Light Pink */ #ffe4e1,
          /* Misty Rose */ #fff4cc,
          /* Pale Yellow */ #d4f0f0,
          /* Light Cyan */ #e0c3fc,
          /* Light Purple */ #ffc4e1 /* Loop back to Pink */
        );
        background-size: 400% 400%;

        /* ANIMATION: Smooth flow */
        animation: rainbow-flow 6s ease infinite;

        /* SHADOW: Soft Pink Glow */
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15),
          0 2px 10px rgba(255, 20, 147, 0.6);
        border: 2px solid white; /* Adds a nice 'sticker' look */
      }

      /* Keep the animation keyframes */
      @keyframes rainbow-flow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      /* The Keyframe Animation for the rainbow */
      @keyframes rainbow-flow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      /* --- FAB & MODAL --- */
      .fab {
        bottom: 30px;
        right: 30px;
        background: var(--accent-pop);
        width: 65px;
        height: 65px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 6px 20px rgba(255, 20, 147, 0.4);
        cursor: pointer;
        z-index: 200;
        border: 4px solid white;
        color: white;
        font-size: 30px;
        transition: transform 0.2s;
      }
      .fab:hover {
        transform: scale(1.1) rotate(10deg);
      }

      #popup-backdrop {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(8px);
        z-index: 999;
        align-items: center;
        justify-content: center;
      }
      #popup-content {
        background: white;
        width: 85%;
        max-width: 400px;
        padding: 40px 20px 30px 20px;
        border-radius: 30px;
        text-align: center;
        border: 4px solid #ffb6c1;
        box-shadow: 0 20px 60px rgba(255, 105, 180, 0.3);
        position: relative;
      }
      #popup-close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: #ffe4e1;
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        color: var(--accent-pop);
        font-weight: bold;
        font-size: 1.2rem;
        cursor: pointer;
      }
      #roulette-container {
        height: 80px;
        overflow: hidden;
        border-top: 3px dashed #ffb6c1;
        border-bottom: 3px dashed #ffb6c1;
        background: #fffafa;
        margin-top: 10px;
      }
      .roulette-item {
        height: 80px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .roulette-item span:first-child {
        color: var(--accent-pop) !important;
        font-size: 1.1rem;
      }
      .roulette-item span:last-child {
        color: #333 !important;
        font-size: 1.3em;
        font-weight: 700;
      }
    </style>
  </head>
  <body>
    <div class="header-container">
      <h1>
        <img
          src="https://em-content.zobj.net/source/apple/391/cherry-blossom_1f338.png"
          style="width: 36px; vertical-align: -6px; margin: 0 5px"
        />
        Song List
        <img
          src="https://em-content.zobj.net/source/apple/391/cherry-blossom_1f338.png"
          style="width: 36px; vertical-align: -6px; margin: 0 5px"
        />
      </h1>
      <div class="controls">
        <button id="random-song" class="fab">ğŸ²</button>
        <input type="text" id="search" placeholder="ë…¸ë˜ ë˜ëŠ” ê°€ìˆ˜ ê²€ìƒ‰..." />

        <button id="recommend-toggle" class="toggle-btn">
          <span>â­ ì¶”ì²œê³¡</span>
        </button>

        <select id="genre-filter">
          <option value="">ì „ì²´ ì¥ë¥´</option>
        </select>
      </div>
    </div>

    <div id="karaoke-book"></div>

    <div id="popup-backdrop">
      <div id="popup-content"></div>
    </div>

    <script>
      const songList = [
        {
          letter: "ã„±",
          artists: [
            {
              name: "ê°•ìˆ˜ì§€",
              songs: [{ track: "ë³´ëë¹› í–¥ê¸°", genre: "romantic" }],
            },
            {
              name: "ê²½ì„œ",
              songs: [
                { track: "ë‚˜ì˜ Xì—ê²Œ", genre: "ballad" },
                { track: "ì¹µí…Œì¼ ì‚¬ë‘", genre: "indie", recommended: true },
              ],
            },
            {
              name: "ê¹€ê´‘ì§„",
              songs: [{ track: "í¸ì§€", genre: "ballad" }],
            },
            {
              name: "ê¹€ìœ¤ì•„",
              songs: [{ track: "ë´„ë‚ ì€ ê°„ë‹¤", genre: "ballad" }],
            },
          ],
        },
        {
          letter: "ã„´",
          artists: [
            {
              name: "ë‚¨ê·œë¦¬",
              songs: [{ track: "ê¹Šì€ ë°¤ì„ ë‚ ì•„ì„œ", genre: "romantic" }],
            },
            {
              name: "ë‰´ì§„ìŠ¤",
              songs: [
                { track: "Ditto", genre: "dance" },
                { track: "Hurt", genre: "dance" },
                { track: "Hype boy", genre: "dance" },
                { track: "Super shy", genre: "dance" },
              ],
            },
          ],
        },
        {
          letter: "ã„·",
          artists: [
            {
              name: "ë‹¤ë¹„ì¹˜",
              songs: [{ track: "8282(300)", genre: "dance" }],
            },
            {
              name: "ë” ë„›ì¸ ",
              songs: [{ track: "ì‚¬ë‘ì˜ ë°”ë³´", genre: "rock" }],
            },
          ],
        },
        {
          letter: "ã„¹",
          artists: [
            {
              name: "ëŸ¼ë¸”í”¼ì‰¬",
              songs: [
                { track: "I Go", genre: "rock" },
                { track: "ë‚´ ì‚¬ë‘ ë‚´ ê³ì—", genre: "ballad" },
                { track: "ë¹„ì™€ë‹¹ì‹ ", genre: "ballad" },
              ],
            },
            {
              name: "ë¦°",
              songs: [{ track: "ì‹œê°„ì„ ê±°ìŠ¬ëŸ¬", genre: "ballad" }],
            },
          ],
        },
        {
          letter: "ã…",
          artists: [
            {
              name: "ë§ˆí¬íˆ½",
              songs: [{ track: "Marry me", genre: "romantic" }],
            },
            {
              name: "ë§ˆí‹´ìŠ¤ë¯¸ìŠ¤",
              songs: [
                { track: "ë´„ ê·¸ë¦¬ê³  ë„ˆ", genre: "romantic", recommended: true },
              ],
            },
            {
              name: "ë©œë¡œë§ìŠ¤",
              songs: [
                { track: "ë¶€ë„ëŸ¼", genre: "romantic" },
                { track: "ì‚¬ë‘ì¸ê°€ë´", genre: "romantic" },
                { track: "ì„ ë¬¼", genre: "romantic" },
              ],
            },
            {
              name: "ë¯¼ì„¤",
              songs: [{ track: "100% ë¡œë§¨í‹±", genre: "indie" }],
            },
          ],
        },
        {
          letter: "ã…‚",
          artists: [
            {
              name: "ë°•ë³´ì˜",
              songs: [
                { track: "ë‚˜ì˜ ì™•ìë‹˜", genre: "romantic" },
                { track: "ì•„ë§ˆë„ ê·¸ê±´", genre: "indie" },
              ],
            },
            {
              name: "ë°•ì •í˜„",
              songs: [{ track: "ë‹¬ì•„ìš”", genre: "romantic" }],
            },
            {
              name: "ë°•ì§„ì˜",
              songs: [{ track: "Honey", genre: "dance" }],
            },
            {
              name: "ë°•í˜œê²½",
              songs: [{ track: "ë™í™”", genre: "romantic" }],
            },
            {
              name: "ë°±ì˜ˆë¦°",
              songs: [
                { track: "Rest", genre: "indie", recommended: true },
                { track: "ì‚°ì±…", genre: "indie" },
              ],
            },
            {
              name: "ë±…í¬",
              songs: [{ track: "ê°€ì§ˆ ìˆ˜ ì—†ëŠ” ë„ˆ", genre: "ballad" }],
            },
            {
              name: "ë²„ìŠ¤ì»¤ë²„ìŠ¤ì»¤",
              songs: [
                { track: "ê³¨ëª©ê¸¸ ì–´ê·€ì—ì„œ", genre: "indie" },
                { track: "ê·¸ëŒ€ ì…ìˆ ì´", genre: "indie" },
                { track: "ê½ƒì†¡ì´ê°€", genre: "indie" },
                { track: "ë²šê½ƒì—”ë”©", genre: "indie" },
                { track: "ì•„ë¦„ë‹¤ìš´ ë‚˜ì´", genre: "indie" },
              ],
            },
            {
              name: "ë²¤",
              songs: [{ track: "You", genre: "ballad" }],
            },
            {
              name: "ë³¼ë¹¨ê°„ ì‚¬ì¶˜ê¸°",
              songs: [
                { track: "ë°”ëŒì‚¬ëŒ", genre: "indie" },
                { track: "ì‹¬ìˆ ", genre: "indie", recommended: true },
                { track: "ì¸íƒˆê±°ì•¼", genre: "indie" },
                { track: "ìš°ì£¼ë¥¼ ì¤„ê²Œ", genre: "indie" },
                { track: "í’ˆ", genre: "indie" },
                { track: "í”„ë¦¬ì§€ì•„", genre: "indie", recommended: true },
              ],
            },
          ],
        },
        {
          letter: "ã……",
          artists: [
            {
              name: "ìƒ˜ê¹€",
              songs: [
                { track: "Like a fool", genre: "r&b", recommended: true },
              ],
            },
            {
              name: "ì„œì˜ì€",
              songs: [
                { track: "ì¢‹ì•„ì¢‹ì•„", genre: "romantic", recommended: true },
              ],
            },
            {
              name: "ì†Œë…€ì‹œëŒ€",
              songs: [{ track: "ì‚¬ë‘ì€ ì„ ìœ¨ì„ íƒ€ê³ ", genre: "romantic" }],
            },
            {
              name: "ì†Œë€",
              songs: [{ track: "ë¯¸ì³¤ë‚˜ë´", genre: "indie" }],
            },
            {
              name: "ìŠ¤íŠ¸ë ˆì´",
              songs: [{ track: "ë„ˆ,ë„ˆ", genre: "ballad", recommended: true }],
            },
            {
              name: "ì‹ ìš©ì¬",
              songs: [{ track: "ì‚¬ë‘í•˜ëŠ” ê·¸ëŒ€ì—¬", genre: "ballad" }],
            },
            {
              name: "ì‹ í˜„í¬ì™€ê¹€ë£¨íŠ¸",
              songs: [{ track: "ì˜¤ë¹ ì•¼", genre: "indie" }],
            },
            {
              name: "ì‹¬ê·œì„ ",
              songs: [{ track: "ë¶€ë””", genre: "ballad" }],
            },
            {
              name: "ì‹­ì„¼ì¹˜10cm",
              songs: [
                { track: "Island", genre: "indie" },
                { track: "Pet", genre: "indie", recommended: true },
                { track: "Talk", genre: "indie" },
                { track: "ê·¸ê²Œ ì•„ë‹ˆê³ ", genre: "indie" },
                { track: "ëƒ„ìƒˆ ë‚˜ëŠ” ì—¬ì", genre: "indie" },
                { track: "ë§¤íŠ¸ë¦¬ìŠ¤", genre: "indie" },
                { track: "ë´„ì´ ì¢‹ëƒ?", genre: "indie", recommended: true },
                { track: "ë¹„ë°€ì—°ì• ", genre: "indie" },
                {
                  track: "ì‚¬ë‘ì€ ì€í•˜ìˆ˜ë‹¤ë°©",
                  genre: "indie",
                  recommended: true,
                },
                { track: "ìŠ¤í† ì»¤", genre: "indie", recommended: true },
                { track: "ì“°ë‹´ì“°ë‹´", genre: "indie" },
                { track: "ì•ˆì•„ì¤˜ìš”", genre: "indie" },
                { track: "ì• ìƒ", genre: "indie" },
                {
                  track: "ì˜¤ëŠ˜ ë°¤ì€ ì–´ë‘ ì´ ë¬´ì„œì›Œìš”",
                  genre: "indie",
                  recommended: true,
                },
                { track: "ì£½ê² ë„¤", genre: "indie", recommended: true },
                { track: "í°ì„œíŠ¸", genre: "indie", recommended: true },
              ],
            },
            {
              name: "ì”¨ì•¼",
              songs: [
                { track: "ê²°í˜¼í• ê¹Œìš”", genre: "romantic" },
                { track: "ì‚¬ë‘ì˜ì¸ì‚¬", genre: "ballad" },
              ],
            },
            {
              name: "ì”¨ì—”ë¸”ë£¨",
              songs: [
                { track: "ì‚¬ë‘ë¹›", genre: "romantic", recommended: true },
              ],
            },
          ],
        },
        {
          letter: "ã…‡",
          artists: [
            {
              name: "1415(ì¼ì‚¬ì¼ì˜¤)",
              songs: [{ track: "ì„ ì„ ê·¸ì–´ì£¼ë˜ê°€", genre: "indie" }],
            },
            {
              name: "ì•„ì´ìœ ",
              songs: [
                { track: "Love poem", genre: "ballad" },
                { track: "Modern times", genre: "dance" },
                { track: "Rain drop", genre: "ballad" },
                { track: "Someday", genre: "ballad", recommended: true },
                { track: "ê³ ì–‘ì´", genre: "romantic" },
                { track: "ê¸ˆìš”ì¼ì— ë§Œë‚˜ìš”", genre: "romantic" },
                { track: "ë„ˆë‘ë‚˜", genre: "dance" },
                { track: "ë ˆì˜¹", genre: "dance" },
                { track: "ë§ˆìŒì„ ë“œë ¤ìš”", genre: "ballad" },
                { track: "ë¬´ë¦", genre: "ballad", recommended: true },
                { track: "ë¯¸ë¦¬ ë©”ë¦¬ í¬ë¦¬ìŠ¤ë§ˆìŠ¤", genre: "romantic" },
                { track: "ë°¤í¸ì§€", genre: "ballad" },
                { track: "ë³µìˆ­ì•„", genre: "romantic" },
                { track: "ë¹¨ê°„ìš´ë™í™”", genre: "romantic" },
                { track: "ì´ëŸ° ì—”ë”©", genre: "ballad" },
                { track: "ì…ìˆ ì‚¬ì´", genre: "romantic" },
                { track: "ì¢‹ì€ ë‚ ", genre: "dance" },
              ],
            },
            {
              name: "ì•„ì¼ë¦¿",
              songs: [{ track: "ë§ˆê·¸ë„¤í‹±", genre: "dance" }],
            },
            {
              name: "ì•ˆì˜ˆì€",
              songs: [{ track: "ìƒì‚¬í™”", genre: "ballad", recommended: true }],
            },
            {
              name: "ì• ì‹¤ë¦¬",
              songs: [{ track: "Lucky", genre: "romantic" }],
            },
            {
              name: "ì–´ì¿ ë£¨ë¸Œ",
              songs: [
                { track: "Rainy", genre: "acoustic" },
                { track: "ê³ ë°±", genre: "acoustic" },
                { track: "ì ê¹ë§Œìš”", genre: "acoustic", recommended: true },
              ],
            },
            {
              name: "ì–´ì¿ ìŠ¤í‹± ì½œë¼ë³´",
              songs: [
                { track: "ê·¸ëŒ€ì™€ ë‚˜ ì„¤ë ˆì„", genre: "acoustic" },
                { track: "ë¬˜í•´, ë„ˆì™€", genre: "acoustic", recommended: true },
              ],
            },
            {
              name: "ì—ì½”",
              songs: [{ track: "í–‰ë³µí•œ ë‚˜ë¥¼", genre: "romantic" }],
            },
            {
              name: "ì˜¤ì™ ",
              songs: [{ track: "Picnic", genre: "acoustic" }],
            },
            {
              name: "ì˜¤í˜",
              songs: [{ track: "ì†Œë…€", genre: "indie" }],
            },
            {
              name: "ì›ëª¨ì°¬ìŠ¤",
              songs: [
                { track: "ë„ ìƒê°í•´", genre: "indie", recommended: true },
              ],
            },
            {
              name: "ìœ ì¬í•˜",
              songs: [{ track: "ì‚¬ë‘í•˜ê¸° ë•Œë¬¸ì—", genre: "ballad" }],
            },
            {
              name: "ìœ¤í•˜",
              songs: [
                { track: "ë¹„ë°€ë²ˆí˜¸486(300)", genre: "ballad" },
                { track: "ì‚¬ê±´ì˜ ì§€í‰ì„ (300)", genre: "ballad" },
              ],
            },
            {
              name: "ì´ì„ í¬",
              songs: [{ track: "ì—¬ìš°ë¹„", genre: "ballad" }],
            },
            {
              name: "ì´ìŠ¹ê¸°",
              songs: [
                { track: "Smile boy", genre: "rock" },
                { track: "ë‚´ ì—¬ìë¼ë‹ˆê¹Œ", genre: "ballad" },
              ],
            },
            {
              name: "ì´ìŠ¹í›ˆ",
              songs: [{ track: "ë‚´ê°€ ë§ì´ ì‚¬ë‘í•´ìš”", genre: "ballad" }],
            },
            {
              name: "ì´ì˜ˆì¤€",
              songs: [{ track: "ë¯¸ì¹œì†Œë¦¬", genre: "ballad" }],
            },
            {
              name: "ìµìŠ¤",
              songs: [{ track: "ì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤", genre: "rock" }],
            },
          ],
        },
        {
          letter: "ã…ˆ",
          artists: [
            {
              name: "ìì´ì–¸í‹°",
              songs: [
                { track: "êº¼ë‚´ë¨¹ì–´ìš”", genre: "r&b" },
                { track: "ë»”í•œ ë©œë¡œë””", genre: "r&b" },
              ],
            },
            {
              name: "ìì „ê±°íƒ„í’ê²½",
              songs: [{ track: "ë„ˆì—ê²Œ ë‚œ, ë‚˜ì—ê²Œ ë„Œ", genre: "indie" }],
            },
            {
              name: "ì¥ê·¼ì„",
              songs: [{ track: "ì–´ë–¡í•˜ì£ ", genre: "ballad" }],
            },
            {
              name: "ì¥ìœ¤ì •",
              songs: [{ track: "ì•½ì†", genre: "ballad", recommended: true }],
            },
            {
              name: "ì •ì—½",
              songs: [{ track: "Nothing better", genre: "r&b" }],
            },
            {
              name: "ì œì´ë ˆë¹—",
              songs: [
                { track: "Happy things", genre: "indie" },
                { track: "ìš”ì¦˜ ë„ˆ ë§ì•¼", genre: "indie", recommended: true },
              ],
            },
            {
              name: "ì¡°ì´",
              songs: [
                { track: "Happy birthday to you", genre: "romantic" },
                { track: "ë‚´ê²Œ ì˜¤ëŠ” ê¸¸", genre: "ballad" },
                { track: "ì•ˆë…•", genre: "dance" },
                { track: "ì¢‹ì€ ì‚¬ëŒ ìˆìœ¼ë©´ ì†Œê°œì‹œì¼œì¤˜", genre: "romantic" },
              ],
            },
            {
              name: "ì¡°ìš©í•„",
              songs: [{ track: "ë‹¨ë°œë¨¸ë¦¬", genre: "dance" }],
            },
            {
              name: "ì¥¬ì–¼ë¦¬",
              songs: [{ track: "ë‹ˆê°€ ì°¸ ì¢‹ì•„", genre: "dance" }],
            },
          ],
        },
        {
          letter: "ã…Š",
          artists: [
            {
              name: "ì°¸ê¹¨ì™€ ì†œì‚¬íƒ•",
              songs: [{ track: "í‚¤ìŠ¤ë¯¸", genre: "indie", recommended: true }],
            },
            {
              name: "ìµœìœ ë¦¬",
              songs: [
                { track: "ë°”ë‹¤", genre: "indie" },
                { track: "ìˆ²", genre: "indie" },
              ],
            },
            {
              name: "ì¹˜ì¦ˆ",
              songs: [
                { track: "Mood indigo", genre: "indie" },
                { track: "ì‚¬ë‘ì´ë¼ì˜¤", genre: "indie", recommended: true },
              ],
            },
          ],
        },
        {
          letter: "ã…‹",
          artists: [
            {
              name: "QWER",
              songs: [
                { track: "ê³ ë¯¼ì¤‘ë…", genre: "rock" },
                { track: "ë‚´ ì´ë¦„ ë§‘ìŒ", genre: "rock" },
              ],
            },
            {
              name: "ì¼€ì´ì‹œ",
              songs: [
                { track: "ì†ì„ ì¡ì•„ì¤˜", genre: "ballad", recommended: true },
              ],
            },
            {
              name: "í¬ëŸ¬ì‰¬",
              songs: [
                { track: "ê°€ë”", genre: "r&b" },
                { track: "ë¯¸ì›Œ", genre: "r&b" },
              ],
            },
          ],
        },
        {
          letter: "ã…Œ",
          artists: [
            {
              name: "2am",
              songs: [{ track: "ì–´ë–¡í•˜ì£ ", genre: "dance" }],
            },
            {
              name: "íƒœì—°",
              songs: [{ track: "ê·¸ëŒ€ë¼ëŠ” ì‹œ", genre: "ballad" }],
            },
            {
              name: "í‹°íŒŒë‹ˆ",
              songs: [{ track: "ë‚˜ í˜¼ìì„œ", genre: "ballad" }],
            },
            {
              name: "íŒ€",
              songs: [
                { track: "ì‚¬ë‘í•œ ë§Œí¼", genre: "ballad" },
                { track: "ì‚¬ë‘í•©ë‹ˆë‹¤", genre: "ballad" },
              ],
            },
          ],
        },
        {
          letter: "ã…",
          artists: [
            {
              name: "40",
              songs: [
                { track: "ë“£ëŠ”í¸ì§€", genre: "r&b" },
                { track: "ë´„ì„ ë…¸ë˜í•˜ë‹¤", genre: "r&b" },
              ],
            },
            {
              name: "í€ì¹˜",
              songs: [{ track: "ë°¤ì´ë˜ë‹ˆê¹Œ", genre: "ballad" }],
            },
            {
              name: "í¬ë§¨",
              songs: [{ track: "Baby baby", genre: "ballad" }],
            },
            {
              name: "í¬ì§€ì…˜",
              songs: [{ track: "í•˜ë£¨", genre: "ballad" }],
            },
          ],
        },
        {
          letter: "ã…",
          artists: [
            {
              name: "í—ˆê°",
              songs: [{ track: "1440", genre: "romantic" }],
            },
            {
              name: "í—ˆë°ì–´ë°˜ìŠ¤í…Œë ˆì˜¤",
              songs: [{ track: "ìƒëŸ¬ë“œ ê¸°ë…ì¼", genre: "indie" }],
            },
            {
              name: "í˜ì˜¤",
              songs: [{ track: "ìœ„ì‰ìœ„ì‰", genre: "indie" }],
            },
          ],
        },
        {
          letter: "A",
          artists: [
            {
              name: "Anne-Marie",
              songs: [{ track: "2002", genre: "pop" }],
            },
            {
              name: "Asher Book",
              songs: [{ track: "Try", genre: "pop" }],
            },
          ],
        },
        {
          letter: "C",
          artists: [
            {
              name: "ChoQMay (ì´ˆíë©”ì´)",
              songs: [
                {
                  track: "å›ã®å½¼æ°ã«ãªã‚ŠãŸã„ (ë„ˆì˜ ì—°ì¸ì´ ë˜ê³  ì‹¶ì–´)",
                  genre: "jpop",
                },
              ],
            },
          ],
        },
        {
          letter: "F",
          artists: [
            {
              name: "Frank Sinatra",
              songs: [
                {
                  track: "Fly me to the moon",
                  genre: "ballad",
                  recommended: true,
                },
              ],
            },
            {
              name: "Frankie Valli",
              songs: [
                {
                  track: "Can't take my eyes off you",
                  genre: "ballad",
                  recommended: true,
                },
              ],
            },
          ],
        },
        {
          letter: "G",
          artists: [
            {
              name: "Glen Hansard & Marketa Irglova",
              songs: [{ track: "Falling Slowly", genre: "ballad" }],
            },
          ],
        },
        {
          letter: "K",
          artists: [
            {
              name: "Karina",
              songs: [{ track: "Slow motion", genre: "pop" }],
            },
            {
              name: "Kelly Clarkson",
              songs: [
                { track: "White Christmas", genre: "pop", recommended: true },
              ],
            },
          ],
        },
        {
          letter: "M",
          artists: [
            {
              name: "M.Y.M.P",
              songs: [{ track: "Say you love me", genre: "ballad" }],
            },
          ],
        },
        {
          letter: "N",
          artists: [
            {
              name: "Natalie Cole",
              songs: [{ track: "L.O.V.E", genre: "ballad", recommended: true }],
            },
          ],
        },
        {
          letter: "S",
          artists: [
            {
              name: "Sixpence None The Richer",
              songs: [{ track: "Kiss Me", genre: "pop", recommended: true }],
            },
            {
              name: "Sneha",
              songs: [
                { track: "So this is love", genre: "pop", recommended: true },
              ],
            },
            {
              name: "Stephanie Poetri",
              songs: [{ track: "I love you 3000", genre: "pop" }],
            },
          ],
        },
        {
          letter: "Y",
          artists: [
            {
              name: "Yuuri",
              songs: [{ track: "ãƒ™ãƒ†ãƒ«ã‚®ã‚¦ã‚¹ (ë² í…”ê¸°ìš°ìŠ¤)", genre: "jpop" }],
            },
          ],
        },
      ];

      const genreCategory = {
        ballad: "ë°œë¼ë“œ",
        jpop: "J-Pop",
        pop: "íŒ",
        dance: "ëŒ„ìŠ¤",
        romantic: "ë¡œë§¨í‹±",
        indie: "ì¸ë””",
        "r&b": "R&B",
        acoustic: "ì–´ì¿ ìŠ¤í‹±",
        rock: "ë¡",
      };

      const container = document.getElementById("karaoke-book");
      const searchInput = document.getElementById("search");
      const genreFilter = document.getElementById("genre-filter");

      const recommendToggle = document.getElementById("recommend-toggle");
      let showRecommendedOnly = false;

      function render(filteredList) {
        container.innerHTML = "";

        if (filteredList.length === 0) {
          container.innerHTML =
            "<div style='text-align:center; color:#db7093; margin-top:20px;'>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>";
          return;
        }

        filteredList.forEach((section) => {
          const sectionDiv = document.createElement("div");
          sectionDiv.className = "section";

          const letter = document.createElement("div");
          letter.className = "letter";
          letter.textContent = `${section.letter}`;
          sectionDiv.appendChild(letter);

          section.artists.forEach((artist) => {
            const artistDiv = document.createElement("div");
            artistDiv.className = "artist";
            artistDiv.textContent = artist.name;
            sectionDiv.appendChild(artistDiv);

            artist.songs.forEach((song) => {
              const songDiv = document.createElement("div");
              songDiv.className = "song";

              const track = song.track;
              const match = track.match(/^(.*?)(\(|ï¼ˆ)(.*?)(\)|ï¼‰)$/);

              let htmlContent = "";
              if (match && match[3].trim() !== "=I") {
                htmlContent = `${match[1].trim()} <span class="highlight">(${match[3].trim()})</span>`;
              } else {
                htmlContent = track;
              }

              // Recommend Badge
              if (song.recommended) {
                htmlContent += ` <span class="recommend-badge">â­ ì¶”ì²œ!</span>`;
              }

              songDiv.innerHTML = `<span class="song-title">${htmlContent}</span>`;
              sectionDiv.appendChild(songDiv);
            });
          });

          container.appendChild(sectionDiv);
        });
      }

      function filterSongs() {
        const query = searchInput.value;
        const genre = genreFilter.value;

        const hasQuery = query && query.trim() !== "";
        const hasGenre = genre && genre.trim() !== "";

        const lowerQuery = hasQuery ? query.toLowerCase() : null;

        return songList
          .map((section) => {
            const filteredArtists = section.artists
              .map((artist) => {
                let filteredSongs = artist.songs;

                // 1. Filter by Genre
                if (hasGenre) {
                  filteredSongs = filteredSongs.filter(
                    (song) => song.genre === genre
                  );
                }

                // 2. Filter by Search Query (Track Name OR Artist Name)
                if (hasQuery) {
                  const artistMatches = artist.name
                    .toLowerCase()
                    .includes(lowerQuery);
                  if (!artistMatches) {
                    filteredSongs = filteredSongs.filter((song) =>
                      song.track.toLowerCase().includes(lowerQuery)
                    );
                  }
                }

                // 3. Filter by Recommended Toggle
                if (showRecommendedOnly) {
                  filteredSongs = filteredSongs.filter(
                    (song) => song.recommended === true
                  );
                }

                if (filteredSongs.length > 0) {
                  return { ...artist, songs: filteredSongs };
                }
                return null;
              })
              .filter(Boolean);

            if (filteredArtists.length > 0) {
              return { ...section, artists: filteredArtists };
            }
            return null;
          })
          .filter(Boolean);
      }

      // Populate Genre Dropdown
      const genreEntries = Object.entries(genreCategory).sort((a, b) => {
        const isAKorean = /[ê°€-í£]/.test(a[1]);
        const isBKorean = /[ê°€-í£]/.test(b[1]);
        if (isAKorean && !isBKorean) return -1;
        if (!isAKorean && isBKorean) return 1;
        return a[1].localeCompare(b[1], isAKorean ? "ko" : "en");
      });
      genreEntries.forEach(([key, value]) => {
        const option = document.createElement("option");
        option.value = key;
        option.textContent = value;
        genreFilter.appendChild(option);
      });

      // Event Listeners
      searchInput.addEventListener("input", function () {
        render(filterSongs());
      });

      genreFilter.addEventListener("change", function () {
        render(filterSongs());
      });

      recommendToggle.addEventListener("click", function () {
        showRecommendedOnly = !showRecommendedOnly;
        this.classList.toggle("active");
        render(filterSongs());
      });

      render(songList);

      // --- RANDOM SONG LOGIC ---
      document
        .getElementById("random-song")
        .addEventListener("click", function () {
          const allSongs = songList.flatMap((section) =>
            section.artists.flatMap((artist) =>
              artist.songs.map((song) => ({
                artist: artist.name,
                track: song.track,
              }))
            )
          );

          const rouletteItems = [];
          for (let i = 0; i < 30; i++) {
            rouletteItems.push(
              allSongs[Math.floor(Math.random() * allSongs.length)]
            );
          }
          const finalSong =
            allSongs[Math.floor(Math.random() * allSongs.length)];
          rouletteItems.push(finalSong);

          const rouletteList = rouletteItems
            .map(
              (song) =>
                `<div class="roulette-item">
                <span style="font-weight:900;">${song.artist}</span>
                <span style="font-weight:600;">${song.track}</span>
             </div>`
            )
            .join("");

          const popupBackdrop = document.getElementById("popup-backdrop");
          const popupContent = document.getElementById("popup-content");
          popupBackdrop.style.display = "flex";

          popupContent.innerHTML = `
            <button id="popup-close-btn">âœ–</button>
            <div style="font-size:1.4em;color:#ff1493;margin-bottom:10px; font-weight:800;">ëœë¤ ë…¸ë˜!</div>
            <div id="roulette-container"><div class="roulette-list">${rouletteList}</div></div>
          `;

          document
            .getElementById("popup-close-btn")
            .addEventListener("click", () => {
              popupBackdrop.style.display = "none";
            });

          const listElem = popupContent.querySelector(".roulette-list");
          const itemHeight = 80;
          let spins = 0,
            maxSpins = 70,
            position = itemHeight * (rouletteItems.length - 1),
            speed = 0.7;

          listElem.style.transform = `translateY(-${position}px)`;
          void listElem.offsetHeight;

          setTimeout(() => {
            function animateRoulette() {
              const elapsed = 16;
              if (spins < maxSpins) {
                if (spins > maxSpins - 10) speed *= 0.97;
                position -= speed * elapsed;
                if (position < 0) position = 0;
                listElem.style.transform = `translateY(-${position}px)`;
                spins += (speed * elapsed) / itemHeight;
                requestAnimationFrame(animateRoulette);
              } else {
                listElem.style.transition =
                  "transform 0.7s cubic-bezier(.4,2,.3,1)";
                listElem.style.transform = `translateY(0px)`;
                setTimeout(() => {
                  if (popupBackdrop.style.display !== "none") {
                    popupContent.innerHTML = `
                        <button id="popup-close-btn">âœ–</button>
                        <div style="font-size:1.4em;color:#ff1493;margin-bottom:15px; font-weight:800;">ëœë¤ ë…¸ë˜!</div>
                        <div style="font-size:1.1em;color:#333; margin-bottom:10px;">
                          <span style="font-weight:900; color:#ff69b4; display:block; margin-bottom:5px; font-size:1.2em;">${finalSong.artist}</span>
                          <span style="font-weight:600;">${finalSong.track}</span>
                        </div>
                      `;
                    document
                      .getElementById("popup-close-btn")
                      .addEventListener("click", () => {
                        popupBackdrop.style.display = "none";
                      });
                  }
                }, 1200);
              }
            }
            animateRoulette();
          }, 10);
        });
    </script>
  </body>
</html>
